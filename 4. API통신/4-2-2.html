<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fetch</title>
</head>
<body>
<h2>fetch() - 상태 코드 분기처리</h2>
<button id="loadBtn">데이터 가져오기</button>
<pre id="result"></pre>

<script>
    document.getElementById('loadBtn').addEventListener('click', () => {
        fetch('https://jsonplaceholder.typicode.com/todos/5@#$@#$#!$!@$!@$') //  https://jsonplaceholder.typicode.com/todos/5@#$@#$#!$!@$!@$ -> 오류
            .then(response => {
                console.log('[1] fetch 결과 (response 객체):', response);
                if (!response.ok) {
                    // 2xx가 아니면(에러면)
                    throw new Error('HTTP 오류! 상태 코드: ' + response.status);
                }
                // 2xx면 데이터 파싱 진행
                return response.json();
            })
            .then(data => {
                console.log('[2] response.json() 결과 (파싱된 데이터):', data);
                document.getElementById('result').textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                console.log('[3] 에러 발생:', error);
                document.getElementById('result').textContent = "에러 발생: " + error;
            });
    });
</script>
</body>
</html>
